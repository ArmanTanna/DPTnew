<script language="JavaScript">
function viaMk() {
	myRegExp = /mk:@MSITStore:[^.]+.chm::/gim;
	myRepStr = "https://dpt3.dptcorporate.com/Content/Help"
	document.body.innerHTML = document.body.innerHTML.replace(myRegExp,myRepStr);
}
</script>
<!-- LJEM -->
<!-- Error Handler removed 03 June 2014 -->
<HTML>
<HEAD>

<meta name="T_2009t1" content="cleanup">
<TITLE>Job: Mail.exe</TITLE>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<LINK href="../../../JSandSTYLES/t32000vNOHR.css" rel="stylesheet" type="text/css"> 

<style>.noleft{margin-left:22; margin-top:0}</style>

</HEAD>



<A NAME="top"></A>
<H1>Mail.exe </H1>

<H3>Purpose</H3>
Asynchronous/deferred sending of e-mail messages.

<H3>Details</H3>

This auxiliary program can be used to perform asynchronous or deferred sending of e-mail messages, including the special ones generated by  <b>ThinkDesign</b>
through the <b>Help<img src="../../../images/general/litarr.gif">Send a Note</b> form or the <b>Help<img src="../../../images/general/litarr.gif">Registration</b> wizard.

<P>Here are the advantages of using <b>Mail.exe</b>:
<ul class="noleft">
<LI>
Faster operations in <b>ThinkDesign</b> (data are rapidly written on disk, not suffering
from any delay due to actual e-mail dispatching)</LI>
<LI>
No risk of <b>ThinkDesign</b> getting stuck as a consequence of network or MAPI spooler
problems</LI>
<LI>
Ability to collect messages from multiple workstations in a centralized
network repository, and have them sent by Mail.exe running as a service
(daemon) on a single machine (no need of e-mail clients or MAPI services
installed on each workstation where <b>ThinkDesign</b> is used)</LI>
</UL>

<H3>Usage</H3>

<DL><B><TT>Mail.exe [options]</TT></B>

<P>Where allowed options are:
<table>
<tr valign="top">
<td><B><TT>-sn &lt;dir></TT></B></td>
<td><I>Send-a-Note</I> mode: the &lt;dir> directory (required) contains one
or more messages generated by <b>ThinkDesign</b>'s <b>Send-a-Note</b> tool. Multiple directories (messages) can be processed in a single run by using wildcards, as explained below.</td>
</tr>
<tr valign="top">
<td><B><TT>-to "x"</TT></B></td>
<td>Defines the recipient(s) of the message</td>
</tr>
<tr valign="top">
<td><B><TT>-subject "x"</TT></B></td>
<td>Defines the subject of the message</td>
</tr>
<tr valign="top">
<td><B><TT>-text "x"</TT></B></td>
<td>Defines the text of the message as a char string</td>
</tr>
<tr valign="top">
<td><B><TT>-text "@x"</TT></B></td>
<td>Defines the text of the message as the contents of "x" file. Multiple text
files may be processed using wildcards: in this case a separate e-mail
is sent for each text file found, using the same recipient and subject.</td>
</tr>
<tr valign="top">
<td><B><TT>-attach "x"</TT></B></td>
<td>Defines files to be sent with the message as attachments. Multiple file
names can be included in the "x" list, separated by colons (;).</td>
</tr>
<tr valign="top">
<td><B><TT>-del</TT></B></td>
<td>Data has to be removed from disk after successful sending of the message(s)</td>
</tr>
<tr valign="top">
<td><B><TT>-edit</TT></B></td>
<td>Before sending the mails it shows their contents so to do the editings, if any.</td>
<tr valign="top">
<td><B><TT>-log "x"</TT></B></td>
<td>The error messages, if any, are written on the "x" file. If this option is
missing the error messages are displayed on a MessageBox.</td>
</tr>
<tr valign="top">
<td><B><TT>-profile "x"</TT></B></DT>
<td>Use profile "x" to access MAPI services (default: use standard profile)</td>
<tr valign="top">
<td><B><TT>-user "x"</TT></B></td>
<td>Username to be used for logon</td>
</tr>
<tr valign="top">
<td><B><TT>-passwd "x"</TT></B></td>
<td>Password to be used for logon</td>
</tr>
<tr valign="top">
<td><B><TT>-single</TT></B></td>
<td>Together with the "wait" option it allows to schedule the program and to
make it wait for a pre-defined time. This way it is not necessary to activate an
external agent to schedule the program.</td>
</tr>
<tr valign="top">
<td><b><TT>-wait "x"</TT></b></B></td>
<td>
Together with the "single" option it allows to show the wait-range in term
of seconds of the program. Used by itself, it warrants that there is only one
scheduled copy of the program: each time the program starts, it checks that there isn't a copy of itself being executed, on the contrary it waits "x" seconds for the operation being carried out to end; if this doesn't happen, it ends up displaying an error.</td>
</tr>
</table>

<H4>Sending regular e-mail</H4>
<b>Mail.exe</b> can be used to send regular e-mail by supplying all needed data
in the command-line arguments, as in the following examples:
<BR>&nbsp;
<ul class="noleft">
<li><B><TT>Mail.exe -to "TheBoss@company.com" -subj "My salary" -text "Should
be increased"</TT></B>
<B><TT>&nbsp;</TT></B>
<li><B><TT>Mail.exe -to "employee@company.com" -subj "RE: My salary" -text
"@NO_WAY.txt"</TT></B>
<B><TT>&nbsp;</TT></B>
<li><B><TT>Mail.exe -to "manager@company.com" -subj "New plan" -text "Updated
sheet in attachment&nbsp;-attach "c:\My Documents\Plan.xls"</TT></B>
</ul>
<H4>Sending messages generated by Send a Note</H4>
<b>Send a Note</b>, or similar tools, write the data related to a message
in a disk directory: <b>Mail.exe</b> may then be used, with <FONT FACE="Courier New">–sn
</FONT>option, to read the directory and send the message. <br><br>Examples:
<BR><br>
<B><TT>Mail.exe -sn C:\SendMailDir\dirmsg1 -del</TT></B>

<br>Read message data contained in directory "C:\SendMailDir\dirmsg1", send
the message and, if successful, delete "dirmsg1" and all the files it contains.
<BR>Note that no recipient, subject or text are supplied in the command-line:
these information have been written from <b>Send a Note</b> into files
in the message directory.

<P><B><TT>Mail.exe -sn C:\SendMailDir\mail_* -del</TT></B>

<br>Send messages contained in all subdirectories of "C:\SendMailDir" whose
name matches the wildcard expression: "mail_*" (e.g.: mail_001, mail_user1_1,
..). Each subdirectory is deleted after its message has been successfully
sent.

<hr color="silver">
</body>
</html>
