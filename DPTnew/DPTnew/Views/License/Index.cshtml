@model DPTnew.Models.LicenseView

@{
  ViewBag.Title = "Licenses";
}


@section Scripts {
  @if (ViewBag.IsSuperUser)
  {
    <link href="~/Content/jquery-ui.min.css" rel="stylesheet" />
    <script src="~/Scripts/jquery-ui.min.js"></script>
  }
  <script src="~/Scripts/License/table_list_buttons.js"> </script>
  <script type="text/javascript">

    var yourApp = yourApp || {};
    yourApp.Urls = yourApp.Urls || {};
    yourApp.Urls.baseUrl = '@Url.Content("~")';
        yourApp.Urls.exportUrl = '@Url.Action("Export", "User")';
    yourApp.Urls.createUrl = '@Url.Action("Create", "User")';
    yourApp.Urls.validateUrl = '@Url.Action("Validate", "User")';
    yourApp.Urls.licenseStateUrl = '@Url.Action("StateByLicenceId", "License")';

    /* init drop down */
    function initdropdown(table) {

      yadcf.init(table, [
{ column_number: 4, filter_default_label: "Select", data: ["dptxsw", "gbgdm", "tcatiav4", "tdbase", "tddrafting", "tdengineering", "tdengineeringplus", "tdirectrw", "tdmolding", "tdprofessional", "tdstyling", "tdtooling", "tdvar", "tdviewerplus", "tdxchangereader", "thinkapigsm", "thinkcore", "thinkom", "thinkprint", "tteamadd", "tteamdev", "tteamdoc", "tteampcb", "tteampcm", "tteampdm", "webteam"] },
{ column_number: 5, filter_default_label: "Select", data: ["asf", "pl"] },
{ column_number: 6, filter_default_label: "Select", data: ["L", "Fx "] },
{ column_number: 8, filter_default_label: "Select", data: ["j: next month", "e: > 1 year", "h: > 1 month", "g: > 3 months", "k: next 3 months", "m: even later", "c: > 3 years", "a: > 10 years", "i: last month", "b: > 5 years", "f: > 6 months", "d: > 2 years", "l: next year"] },
{ column_number: 9, filter_default_label: "Select", data: ["2008", "2009", "2006", "2011", "2014", "2007", "2005", "2015", "2010", "2012", "2013"] }]);



    }
    /* Formatting function for row details - modify as you need */
    function format(d) {
      debugger
      // `d` is the original data object for the row
      return '<table cellpadding="5" cellspacing="0" border="0" width="100%" style="padding-left:50px;">' +
         '<tr>' +
              '<td><b>Start Date:</b></td>' +
              '<td>' + d.SD + '</td>' +
              '<td><b>End Date:</b></td>' +
              '<td>' + d.ED + '</td>' +
			  '<td><b>Maint Start Date:</b></td>' +
              '<td>' + d.MSD + '</td>' +
              '<td><b>Maint End Date:</b></td>' +
              '<td>' + d.MED + '</td>' +
          '</tr>' +

           '<tr>' +
              '<td><b>Ancestor:</b></td>' +
              '<td>' + d.Ancestor + '</td>' +
              '<td><b>MachineID:</b></td>' +
              '<td>' + d.MachineID + '</td>' +
			  '<td><b>License Kind:</b></td>' +
              '<td>' + d.LicenseKind + '</td>' +
			  '<td><b>Note:</b></td>' +
              '<td>' + d.Note + '</td>' +

          '</tr>' +
               '</table>';
    }




    $(document).ready(function () {
      var ltConfig = {
        serverSide: true,
        processing: true,
        ajax: {
          type: "POST",
          url: "License/Search"
        },
        columns: [
        {
          "className": 'details-control',
          "orderable": false,
          "data": null,
          "defaultContent": ''
        },
        { data: "AccountNumber", "className": 'no-dropdown' },
        { data: "AccountName", "className": 'no-dropdown' },
        { data: "LicenseID", "className": 'no-dropdown' },
        { data: "ProductName" },
        { data: "ArticleDetail", "className": 'mycenter-text'},
        { data: "ServLicense1", "className": 'mycenter-text' }, //union of type and quantity
        { data: "MED", type: "date", "width": "10%", "className": 'no-dropdown', "className": 'mycenter-text' },
        { data: "ExpRange" },
        { data: "Version", "className": 'mycenter-text' }
        ],
        orderClasses: false
      };
      if ("@ViewBag.IsSuperUser.ToString().ToLower()" == "false") {
              var searchFilterHandler = function () {
                debugger
                var api = this.api();
                api.$("td:not(.details-control)").click(function () {
                  api.search(this.innerText).draw();
                  //api.columns(this.cellIndex).search( this.innerHTML ).draw();
                });
              };
              ltConfig.drawCallback = ltConfig.initComplete = searchFilterHandler;
            }

            loadLicenseTable(ltConfig, "@ViewBag.IsSuperUser.ToString().ToLower()" == "true");

        });


  </script>
}

@if (ViewBag.IsSuperUser)
{
    
  <div id="machineid-dialog" title="Please enter your machineid" style="display: none;">
    <input id="machineid" required="required" type="text" size="8" maxlength="8" />
  </div>
  <div id="pwd-dialog" title="Your requested password is" style="display: none;">
    <strong style="position: absolute; margin-top: 20px;" id="password"></strong>
  </div>
}

<table id="licenses" class="display" cellspacing="0" width="100%">
  <thead>
    <tr>
      <th></th>
      <th>
        @Html.DisplayNameFor(model => model.AccountNumber)
      </th>
      <th>
        @Html.DisplayNameFor(model => model.AccountName)
      </th>
      <th>
        @Html.DisplayNameFor(model => model.LicenseID)
      </th>
      <th>
        @Html.DisplayNameFor(model => model.ProductName)
      </th>
      <th>
        @Html.DisplayNameFor(model => model.ArticleDetail)
      </th>

      <th>
        @Html.DisplayNameFor(model => model.ServLicense1)
      </th>
      @*
        <th>
            @Html.DisplayNameFor(model => model.MachineID)
        </th>
       
        <th>
            @Html.DisplayNameFor(model => model.Ancestor)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.StartDate)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.EndDate)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.MaintStartDate)
        </th>*@
      <th>
        @Html.DisplayNameFor(model => model.MaintEndDate)
      </th>
      <th>
        @Html.DisplayNameFor(model => model.ExpRange)
      </th>
      <th>
        @Html.DisplayNameFor(model => model.Version)
      </th>
      @*<th>
            @Html.DisplayNameFor(model => model.LicenseKind)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Note)
        </th>*@
    </tr>
  </thead>
</table>
